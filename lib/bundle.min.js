var version=function(e,t,a,n,l){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(t);const d="description",u="instanceVariable",c="name",s="representedVariable",o="variable",g={DATASET_TYPES:["unitDataSet"],VARIABLE_TYPES:["instanceVariable","representedVariable","variable"]},m="lineageDataset",E={LF_IV:"reverseLineageFieldInstanceVariable",IV_RV:"reverseInstanceVariableRepresentedVariable",RV_V:"reverseRepresentedVariableVariable",UDS_L:"reverseUnitDataSetLineage"},f="smart",b=(l.SSB_COLORS.BLUE,l.SSB_COLORS.GREEN,l.SSB_COLORS.YELLOW,l.SSB_COLORS.RED,{DATA_SOURCE_PATH:{en:"Data source path",nb:"Datasti"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},HAVE_FILTERED:(e,t)=>({en:`Reminder that you have filtered your search, in total there are ${t} hit(s), but you are only showing ${e}`,nb:`Obs, du har filtrert søket, totalt ${t} treff, men etter filtrering vises bare ${e}`}),NAME:{en:"Name",nb:"Navn"},VARIABLE_IN_DATASETS:{en:"Variable linked in datasets",nb:"Datasett denne variabelen er koblet til"}}),S="datasetsAccordionToggle",h="searchDatasetToggle",T={API_ERROR_MESSAGE:{en:"Something went wrong, check settings",nb:"Noe gikk galt, sjekk innstillingene"},CONFIGURE_SEARCH:{en:"Adjust search parameters",nb:"Søkealternativer"},COPY_ID_TO_CLIPBOARD:{en:"Click to copy id to clipboard",nb:"Klikk for å kopiere id til utklippstavlen"},DATASETS:{en:"Datasets",nb:"Datasett"},EDITED:{en:"Current results are from previous search",nb:"Resultatene gjelder forrige søk"},HEADER:{en:"Variable search",nb:"Variabelsøk"},NEW_SEARCH:{en:"Hit 'Enter' for a new search",nb:"Trykk 'Enter' for et nytt søk"},NO_RESULTS:{en:"Found nothing",nb:"Fant ingenting"},OTHER:{en:"Other:",nb:"Annet:"},SEARCH:{en:"Search...",nb:"Søk..."},SEARCH_DATASETS:{en:"Search for datasets as well?",nb:"Søk etter datasett også?"},SHOW_OF_TYPE:(e,t)=>({en:`Of ${T[e][t].toLowerCase()} show me: `,nb:`Av ${T[e][t].toLowerCase()} vis meg: `}),VARIABLES:{en:"Variables",nb:"Variabler"}};function p({searchDataset:e,handleSearchDataset:t,variableTypeFilter:a,handleVariableTypeCheckbox:l,language:r}){const d=[{key:1,title:T.CONFIGURE_SEARCH[r],content:{content:i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Header,{size:"tiny",content:T.SHOW_OF_TYPE("VARIABLES",r)[r]}),i.default.createElement(n.List,null,g.VARIABLE_TYPES.map((e=>i.default.createElement(n.List.Item,{key:e},i.default.createElement(n.Checkbox,{label:e,checked:a.includes(e),onClick:()=>l(a.includes(e),e)}))))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement(n.Header,{size:"tiny",content:T.OTHER[r]}),i.default.createElement(n.Checkbox,{toggle:!0,checked:e,label:T.SEARCH_DATASETS[r],"data-testid":h,onClick:()=>t(!e)}))}}];return i.default.createElement(n.Accordion,{defaultActiveIndex:0,panels:d,styled:!0})}function y({id:e,type:t,language:a}){return i.default.createElement(l.InfoPopup,{text:T.COPY_ID_TO_CLIPBOARD[a],trigger:i.default.createElement(n.Icon,{link:!0,fitted:!0,size:"large",name:"copy outline",style:{color:l.SSB_COLORS.BLUE},onClick:()=>{navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{console.log(`Copied ${t} id to the clipboard: ${e}`)}),(e=>{console.log(e)})):console.log("Copy to clipboard not supported in your browser")}})})}function v({datasets:e,lineageUrl:t,language:a}){return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Table,{basic:"very",selectable:!0},i.default.createElement(n.Table.Header,null,i.default.createElement(n.Table.Row,null,i.default.createElement(n.Table.HeaderCell,{collapsing:!0}),i.default.createElement(n.Table.HeaderCell,null,b.NAME[a]),i.default.createElement(n.Table.HeaderCell,null,b.DESCRIPTION[a]),i.default.createElement(n.Table.HeaderCell,null,b.DATA_SOURCE_PATH[a]),i.default.createElement(n.Table.HeaderCell,null))),i.default.createElement(n.Table.Body,null,e.map((e=>{const r=Object.keys(e)[0],d=e[r],{id:u,name:c,description:s,dataSourcePath:o}=d;return i.default.createElement(n.Table.Row,{key:u},i.default.createElement(n.Table.Cell,{textAlign:"center"},i.default.createElement(y,{id:u,type:r,language:a})),i.default.createElement(n.Table.Cell,null,l.getLocalizedGsimObjectText(a,c)),i.default.createElement(n.Table.Cell,null,l.getLocalizedGsimObjectText(a,s)),i.default.createElement(n.Table.Cell,null,o),i.default.createElement(n.Table.Cell,null,i.default.createElement("a",{href:`${t}?id=${u}&type=dataset`,target:"_blank",rel:"noopener noreferrer"},"Sporing")))})))))}function C({language:e,filtered:t,total:a}){return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Icon,{name:"warning circle",style:{color:l.SSB_COLORS.BLUE}}),b.HAVE_FILTERED(t,a)[e],i.default.createElement(n.Divider,{hidden:!0}))}function _({dataset:e,language:t}){const{name:a,description:r}=e,u=l.getLocalizedGsimObjectText(t,a),s=l.getLocalizedGsimObjectText(t,r);return i.default.createElement(n.Modal,{style:l.SSB_STYLE,content:i.default.createElement(n.Segment,{basic:!0},i.default.createElement(n.Grid,null,Object.entries(e).map((([e,a])=>i.default.createElement(n.Grid.Row,{key:e},i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,e)),i.default.createElement(n.Grid.Column,{width:12},e===c||e===d?l.getLocalizedGsimObjectText(t,a):a)))))),trigger:i.default.createElement("p",null,i.default.createElement("b",null,u),i.default.createElement("br",null),s)})}const A={instanceVariable:"\n    {\n      instanceVariable(filter: {id: $id}) {\n        id\n        reverseLineageFieldInstanceVariable {\n          id\n          smart {\n            id\n            lineageDataset {\n              id\n              reverseUnitDataSetLineage {\n                id\n                name {\n                  languageText\n                  languageCode\n                }\n                description {\n                  languageText\n                  languageCode\n                }\n                version\n                administrativeStatus\n                valuation\n                createdBy\n                lastUpdatedBy\n                metadataSourcePath\n                shortName\n                temporalityType\n                dataSetState\n                dataSourcePath\n              }\n            }\n          }\n        }\n      }\n    }\n  ",representedVariable:"\n    {\n      representedVariable(filter: {id: $id}) {\n        id\n        reverseInstanceVariableRepresentedVariable {\n          id\n          reverseLineageFieldInstanceVariable {\n            id\n            smart {\n              id\n              lineageDataset {\n                id\n                reverseUnitDataSetLineage {\n                  id\n                  name {\n                    languageText\n                    languageCode\n                  }\n                  description {\n                    languageText\n                    languageCode  \n                  }\n                  version\n                  administrativeStatus\n                  valuation\n                  createdBy\n                  lastUpdatedBy\n                  metadataSourcePath\n                  shortName\n                  temporalityType\n                  dataSetState\n                  dataSourcePath\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ",variable:"\n    {\n      variable(filter: {id: $id}) {\n        id\n        reverseRepresentedVariableVariable {\n          id\n          reverseInstanceVariableRepresentedVariable {\n            id\n            reverseLineageFieldInstanceVariable {\n              id\n              smart {\n                id\n                lineageDataset {\n                  id\n                  reverseUnitDataSetLineage {\n                    id\n                    name {\n                      languageText\n                      languageCode\n                    }\n                    description {\n                      languageText\n                      languageCode\n                    }\n                    version\n                    administrativeStatus\n                    valuation\n                    createdBy\n                    lastUpdatedBy\n                    metadataSourcePath\n                    shortName\n                    temporalityType\n                    dataSetState\n                    dataSourcePath\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  "},R=(e,t)=>e.reduce(((e,a)=>{const n=[];let l;switch(t){case u:l=a[t][E.LF_IV];break;case s:l=((e,t)=>{const a=e[t][E.IV_RV],n=[];let l=!1;return 0!==a.length&&(a.forEach((e=>e[E.LF_IV].forEach((e=>n.push(e))))),0!==n.length&&(l=n)),l})(a,t);break;case o:l=((e,t)=>{const a=e[t][E.RV_V],n=[],l=[];let r;return 0!==a.length&&(a.forEach((e=>e[E.IV_RV].forEach((e=>n.push(e))))),0!==n.length&&(n.forEach((e=>e[E.LF_IV].forEach((e=>l.push(e))))),0!==l.length&&(r=l))),r})(a,t);break;default:l=a[t][E.LF_IV]}return l&&0!==l.length&&l.forEach((e=>{const t=e[f];if(0!==t.length){const e=t.filter((e=>e[m].hasOwnProperty(E.UDS_L)&&0!==e[m][E.UDS_L].length));0!==e.length&&e.forEach((e=>{e[m][E.UDS_L].forEach((e=>n.push(e)))}))}})),n}),[]);function L({id:e,type:l,language:r}){const[d,u]=t.useState(-1),[c,s]=t.useState([]),[o,{loading:g,error:m,data:E}]=a.useManualQuery(A[l],{variables:{id:e}});t.useEffect((()=>{if(!g&&!m&&void 0!==E&&Array.isArray(E)&&0!==E.length){const e=R(E,l),t=e.filter(((e,t,a)=>a.findIndex((t=>t.id===e.id))===t));e.length!==t.length&&(console.log("Unfiltered datasets"),console.log(e)),s(t)}}),[g,m,E,l,r]);const f=[{key:1,title:{content:i.default.createElement("b",null,b.VARIABLE_IN_DATASETS[r]),"data-testid":S},content:{content:g?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):c.length>=1?i.default.createElement(n.List,{bulleted:!0,relaxed:!0,style:{padding:"0 1rem 1rem 1rem"}},c.map((e=>{const{id:t}=e;return i.default.createElement(n.List.Item,{key:t,as:"a"},i.default.createElement(_,{dataset:e,language:r}))}))):T.NO_RESULTS[r]}}];return i.default.createElement(n.Accordion,{activeIndex:d,panels:f,onTitleClick:(e,{index:t})=>{d!==t&&o(),u(d===t?-1:t)}})}function O({language:e,lineageUrl:a,variables:r,variableTypeFilter:d}){const[u,c]=t.useState(r.filter((e=>d.includes(Object.keys(e)[0]))));return t.useEffect((()=>{c(r.filter((e=>d.includes(Object.keys(e)[0]))))}),[r,d]),i.default.createElement(i.default.Fragment,null,3!==d.length&&i.default.createElement(C,{language:e,filtered:u.length,total:r.length}),u.map((t=>{const r=Object.keys(t)[0],d=t[r],{id:u,name:c,description:s}=d;return i.default.createElement(n.Segment,{key:u,raised:!0},i.default.createElement(n.Label,{ribbon:!0,color:"blue"},r),i.default.createElement(n.Label,{attached:"top right"},i.default.createElement(y,{id:u,type:r,language:e})),i.default.createElement(n.Grid,{columns:"equal"},i.default.createElement(n.Grid.Column,null,i.default.createElement(n.Divider,{hidden:!0,style:{marginBottom:0}}),i.default.createElement(n.Grid,null,i.default.createElement(n.Grid.Row,null,i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,b.NAME[e])),i.default.createElement(n.Grid.Column,{width:12},l.getLocalizedGsimObjectText(e,c))),i.default.createElement(n.Grid.Row,null,i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,b.DESCRIPTION[e])),i.default.createElement(n.Grid.Column,{width:12},l.getLocalizedGsimObjectText(e,s))))),i.default.createElement(n.Grid.Column,null,i.default.createElement(L,{id:u,type:r,language:e}))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement("a",{href:`${a}?id=${u}&type=${r}`,target:"_blank",rel:"noopener noreferrer"},"Sporing"))})))}return e.VariableSearch=function({lineageUrl:e,language:r}){const[d,u]=t.useState(!1),[c,s]=t.useState(""),[o,m]=t.useState(!1),[E,f]=t.useState(!1),[b,S]=t.useState(""),[h,y]=t.useState([]),[C,_]=t.useState([]),[A,R]=t.useState(g.VARIABLE_TYPES),[L,{loading:I,error:x,data:V}]=a.useManualQuery("\n{\n  instanceVariable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n    representedVariable {\n      id\n      name {\n        languageText\n        languageCode\n      }\n      description {\n        languageText\n        languageCode\n      }\n    }\n  }\n  representedVariable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode  \n    }\n    description {\n      languageText\n      languageCode\n    }\n    variable {\n      id\n      name {\n        languageText\n        languageCode\n      }\n      description {\n        languageText\n        languageCode\n      }\n    }\n  }\n  variable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n  }\n  unitDataSet(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}, {dataSourcePath_contains: $text}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n    version\n    administrativeStatus\n    valuation\n    createdBy\n    dataSourcePath\n    lastUpdatedBy\n    metadataSourcePath\n    shortName\n    temporalityType\n    dataSetState\n  }\n}\n",{variables:{text:c.trim()}});t.useEffect((()=>{if(!x&&!I&&void 0!==V){const t={variables:(e=V).filter((e=>g.VARIABLE_TYPES.some((t=>Object.getOwnPropertyNames(e).includes(t))))),datasets:e.filter((e=>g.DATASET_TYPES.some((t=>Object.getOwnPropertyNames(e).includes(t)))))};y(t.datasets),_(t.variables)}var e}),[x,I,V,r]);const k=[{menuItem:i.default.createElement(n.Menu.Item,{key:"variables"},T.VARIABLES[r],i.default.createElement(n.Label,{style:{background:l.SSB_COLORS.BLUE}},I?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):C.length)),render:()=>C.length>=1?i.default.createElement(n.Tab.Pane,{as:n.Segment,basic:!0,style:{border:"none"}},i.default.createElement(O,{language:r,lineageUrl:e,variables:C,variableTypeFilter:A})):null},{menuItem:i.default.createElement(n.Menu.Item,{key:"datasets"},T.DATASETS[r],i.default.createElement(n.Label,{style:{background:l.SSB_COLORS.BLUE}},I?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):h.length)),render:()=>h.length>=1?i.default.createElement(n.Tab.Pane,{as:n.Segment,basic:!0,style:{border:"none"}},i.default.createElement(v,{language:r,lineageUrl:e,datasets:h})):null}];return i.default.createElement(n.Grid,null,i.default.createElement(n.Grid.Column,{width:3},i.default.createElement(n.Container,{textAlign:"center"},i.default.createElement(n.Search,{size:"huge",open:!1,loading:I,value:c,placeholder:T.SEARCH[r],onKeyPress:({key:e})=>"Enter"===e&&void(c.length>=1&&(u(!0),m(!1),S(c),L())),onSearchChange:(e,{value:t})=>{m(!0),s(t)}}),d&&o&&i.default.createElement(l.InfoText,{text:T.EDITED[r]}),d&&o&&""!==b&&i.default.createElement(i.default.Fragment,null," '",i.default.createElement("b",null,b),"'",i.default.createElement("p",null,T.NEW_SEARCH[r]))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement(p,{language:r,searchDataset:E,variableTypeFilter:A,handleSearchDataset:e=>f(e),handleVariableTypeCheckbox:(e,t)=>{R(e?A.filter((e=>e!==t)):A.concat([t]))}})),i.default.createElement(n.Grid.Column,{width:13},i.default.createElement(n.Tab,{defaultActiveIndex:0,menu:{secondary:!0,pointing:!0},panes:E?k:[k.shift()]})))},Object.defineProperty(e,"__esModule",{value:!0}),e}({},React,graphqlHooks,semanticUiReact,daplaJsUtilities);
