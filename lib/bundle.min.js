var version=function(e,t,n,a,l){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=r(t);const i="/graphql",s={DATASET:"UnitDataSet",GET_CREATED_DATE:["createdDate"],GET_DATASET:["node","reverseUnitDataStructureLogicalRecords","edges",0,"node","reverseUnitDataSetUnitDataStructure","edges",0,"node"],GET_DATASETS:["node","reverseUnitDataStructureLogicalRecords","edges",0,"node","reverseUnitDataSetUnitDataStructure","edges"],GET_DESCRIPTION:["description"],GET_ID:["node","id"],GET_LOGICAL_RECORDS:{InstanceVariable:["InstanceVariableById","reverseLogicalRecordInstanceVariables","edges"],RepresentedVariable:["RepresentedVariableById","reverseInstanceVariableRepresentedVariable","edges",0,"node","reverseLogicalRecordInstanceVariables","edges"],Variable:["VariableById","reverseRepresentedVariableVariable","edges",0,"node","reverseInstanceVariableRepresentedVariable","edges",0,"node","reverseLogicalRecordInstanceVariables","edges"]},GET_NAME:["name"],GET_STATE:["dataSetState"],GET_SUBJECT_FIELD_NAME:["node","name"],GET_SUBJECT_FIELDS:{InstanceVariable:["representedVariable","variable","subjectFields","edges"],RepresentedVariable:["variable","subjectFields","edges"],Variable:["subjectFields","edges"]},GET_UNIT_TYPE:{InstanceVariable:["representedVariable","variable","unitType","name"],RepresentedVariable:["variable","unitType","name"],Variable:["unitType","name"]},GET_VALUATION:["valuation"],SEARCH:["Search","edges"],TYPE:["node","__typename"],VARIABLES:["InstanceVariable","RepresentedVariable","Variable"]},u={OPEN:l.SSB_COLORS.BLUE,INTERNAL:l.SSB_COLORS.GREEN,SHIELDED:l.SSB_COLORS.YELLOW,SENSITIVE:l.SSB_COLORS.RED},c=(l.LANGUAGE.LANGUAGES.NORWEGIAN.languageCode,l.LANGUAGE.LANGUAGES.ENGLISH.languageCode,process.env.REACT_APP_API,process.env.REACT_APP_API,l.LANGUAGE.LANGUAGES.NORWEGIAN.languageCode,{NAME:{en:"Name",nb:"Navn"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},STATE:{en:"State",nb:"Tilstand"},VALUATION:{en:"Valuation",nb:"Verdivurdering"},DATE_CREATED:{en:"Date created",nb:"Dato opprettet"},CURSOR:{en:"Cursor (changes)",nb:"Peker (endringer)"}}),E={DATASET_RESULTS:{en:"Dataset results",nb:"Datasettresultater"},EDITED:{en:"Current results came from a previous search",nb:"Resultatene som foreligger gjelder forrige søk"},HITS:{en:"Number of hits in total",nb:"Antall treff totalt"},NEW_SEARCH:{en:"Hit 'Enter' for a new search",nb:"Trykk 'Enter' for et nytt søk"},PREVIOUS:{en:"wich was: ",nb:"som var: "},VARIABLE_DATASETS_CLOSED:{en:"Hide datasets",nb:"Skjul datasett"},VARIABLE_DATASETS_OPEN:{en:"Show datasets using this variable",nb:"Vis datasett som bruker denne variabelen"},VARIABLE_RESULTS:{en:"Variable results",nb:"Variabelresultater"}},o={CURSOR_OLDER:{en:"Cursors to older versions",nb:"Pekere til eldre versjoner"},DATASET_STATE:{en:"State",nb:"Tilstand"},DATASET_VALUATION:{en:"Valuation",nb:"Verdivurdering"},DATE_CREATED:{en:"Date created",nb:"Dato opprettet"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},NAME:{en:"Name",nb:"Navn"},SUBJECT_FIELDS:{en:"Subject fields",nb:'"Emner"'},TYPE:{en:"Type",nb:"Type"},UNIT_TYPE:{en:"Unit type",nb:"Enhetstype"},UPDATES:{en:"Times changed",nb:"Ganger endret"}},g={API_ERROR_MESSAGE:{en:"Something went wrong, check settings",nb:"Noe gikk galt, sjekk innstillingene"},EXTERNAL_GRAPHIQL:{en:"Access GraphiQL directly",nb:"Skriv Graphql spørringer direkte mot tjenesten"},HEADER:{en:"Variable search",nb:"Variabelsøk"},SEARCH:{en:"Search...",nb:"Søk..."},SEARCH_NO_RESULTS:{en:"No results found",nb:"Fant ingen resultater"},UNKOWN:"-"},S=(e,t)=>void 0===t?g.UNKOWN:l.getLocalizedGsimObjectText(e,t),T=(e,t)=>{const n=l.getNestedObject(t,s.GET_CREATED_DATE);return void 0===n?g.UNKOWN:new Date(n).toLocaleDateString(l.LANGUAGE.LOCALE[e])},b=e=>l.getNestedObject(e,s.GET_STATE),m=e=>l.getNestedObject(e,s.GET_VALUATION),A=(e,t)=>S(e,l.getNestedObject(t,s.GET_DESCRIPTION)),f=(e,t)=>S(e,l.getNestedObject(t,s.GET_NAME)),R=(e,t,n)=>{const r=l.getNestedObject(n,s.GET_SUBJECT_FIELDS[t]);return void 0===r?g.UNKOWN:r.map((t,n)=>((e,t)=>d.default.createElement(a.Label,{tag:!0,key:t,size:"large",content:e,style:{backgroundColor:l.SSB_COLORS.GREEN,borderColor:l.SSB_COLORS.GREEN,marginRight:"0.5em"}}))(S(e,l.getNestedObject(t,s.GET_SUBJECT_FIELD_NAME)),n))},I=(e,t,n)=>S(e,l.getNestedObject(n,s.GET_UNIT_TYPE[t])),L=e=>e.reduceRight((e,t)=>{let n=l.getNestedObject(t,s.GET_ID);return e[n]||(e[n]=[]),e[n].push(t),e},{}),D=e=>{const t=l.getNestedObject(e,s.SEARCH),n=L(t.filter(e=>l.getNestedObject(e,s.TYPE)===s.DATASET));return{variables:L(t.filter(e=>l.getNestedObject(e,s.TYPE)!==s.DATASET)),datasets:n}};function _({datasets:e,language:t}){return d.default.createElement(a.Table,{basic:"very"},d.default.createElement(a.Table.Header,null,d.default.createElement(a.Table.Row,null,Object.entries(c).map(([e,n])=>d.default.createElement(a.Table.HeaderCell,{key:e},n[t])))),d.default.createElement(a.Table.Body,null,Object.entries(e).map(([e,n])=>d.default.createElement(a.Table.Row,{key:e},d.default.createElement(a.Table.Cell,null,f(t,n[0].node)),d.default.createElement(a.Table.Cell,null,A(t,n[0].node)),d.default.createElement(a.Table.Cell,null,b(n[0].node)),d.default.createElement(a.Table.Cell,null,d.default.createElement("span",{style:{color:u[m(n[0].node)]}},m(n[0].node))),d.default.createElement(a.Table.Cell,null,T(t,n[0].node)),d.default.createElement(a.Table.Cell,null,`${n[0].cursor} (${n.length-1})`)))))}const O={InstanceVariable:"\n    query getDatasetsByInstanceVariable($id: ID!) {\n      InstanceVariableById(id: $id) {\n        reverseLogicalRecordInstanceVariables {edges {node {\n          reverseUnitDataStructureLogicalRecords {edges {node {\n            reverseUnitDataSetUnitDataStructure {edges {node {\n              id\n              name {languageText}\n              description {languageText}\n              createdDate\n              dataSetState\n              valuation\n            }}}\n          }}}\n        }}}\n      }\n    }\n  ",RepresentedVariable:"\n    query getDatasetsByRepresentedVariable($id: ID!) {\n      RepresentedVariableById(id: $id) {\n        reverseInstanceVariableRepresentedVariable {edges {node {\n          reverseLogicalRecordInstanceVariables {edges {node {\n            reverseUnitDataStructureLogicalRecords {edges {node {\n              reverseUnitDataSetUnitDataStructure {edges {node {\n                id\n                name {languageText}\n                description {languageText}\n                createdDate\n                dataSetState\n                valuation\n              }}}\n            }}}\n          }}}\n        }}}\n      }\n    }\n  ",Variable:"\n    query getDatasetsByVariable($id: ID!) {\n      VariableById(id: $id) {\n        reverseRepresentedVariableVariable {edges {node {\n          reverseInstanceVariableRepresentedVariable {edges {node {\n            reverseLogicalRecordInstanceVariables {edges {node {\n              reverseUnitDataStructureLogicalRecords {edges {node {\n                reverseUnitDataSetUnitDataStructure {edges {node {\n                  id\n                  name {languageText}\n                  description {languageText}\n                  createdDate\n                  dataSetState\n                  valuation\n                }}}\n              }}}\n            }}}\n          }}}\n        }}}\n      }\n    }\n  "};function p({id:e,language:r,variables:i}){const[u,c]=t.useState([]),[S,L]=t.useState(!1),{loading:D,error:_,data:p}=n.useQuery(O[i[0].node[s.TYPE[1]]],{variables:{id:e}});return t.useEffect(()=>{_||D||void 0===p||c(((e,t)=>{const n=l.getNestedObject(e,s.GET_LOGICAL_RECORDS[t]);if(void 0!==n)return 0!==n.filter(e=>0!==l.getNestedObject(e,s.GET_DATASETS).length).length?n.map(e=>l.getNestedObject(e,s.GET_DATASET)).filter(e=>void 0!==e):[];return[]})(p,i[0].node[s.TYPE[1]]))},[_,D,p,i]),t.useEffect(()=>{_&&!D&&console.log(_)},[_,D]),d.default.createElement(a.Segment,{textAlign:"left"},d.default.createElement(l.InfoPopup,{text:o.UNIT_TYPE[r],trigger:d.default.createElement(a.Label,{ribbon:!0,size:"large",style:{backgroundColor:l.SSB_COLORS.BLUE,borderColor:l.SSB_COLORS.BLUE}},I(r,i[0].node[s.TYPE[1]],i[0].node))}),d.default.createElement(a.Grid,{columns:"equal"},d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(a.List,{relaxed:!0},d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.TYPE[r]+": "),i[0].node[s.TYPE[1]]),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.NAME[r]+": "),f(r,i[0].node)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.DESCRIPTION[r]+": "),A(r,i[0].node)),i.length>1&&d.default.createElement(a.List.Item,null,d.default.createElement("b",null,`${o.UPDATES[r]}: ${i.length-1} `),`\n              (${o.CURSOR_OLDER[r]}:\n              ${i.map(e=>e.cursor).filter((e,t)=>0!==t).join(", ")})\n              `)),d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(l.InfoPopup,{text:o.SUBJECT_FIELDS[r],trigger:d.default.createElement(a.Container,null,R(r,i[0].node[s.TYPE[1]],i[0].node))})),d.default.createElement(a.Grid.Column,null,d.default.createElement(l.InfoPopup,{position:"left center",text:E["VARIABLE_DATASETS_"+(S?"CLOSED":"OPEN")][r],trigger:d.default.createElement(a.Label,{floating:!0,size:"large",onClick:()=>L(!S),style:{backgroundColor:l.SSB_COLORS.PURPLE,borderColor:l.SSB_COLORS.PURPLE}},d.default.createElement(a.Icon,{name:S?"minus circle":"plus circle"}))}),S?u.length>=1?u.map(e=>d.default.createElement(a.List,{key:e.id,relaxed:!0},d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.NAME[r]+": "),f(r,e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.DESCRIPTION[r]+": "),A(r,e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.DATASET_STATE[r]+": "),b(e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.DATASET_VALUATION[r]+": "),m(e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,o.DATE_CREATED[r]+": "),T(r,e)))):g.SEARCH_NO_RESULTS[r]:null)),S&&u.length>=1&&d.default.createElement(a.Divider,{vertical:!0},d.default.createElement(a.Icon,{name:"arrow circle right"})))}return e.VariableSearch=function({restApi:e,language:r}){const[i,u]=t.useState(!1),[c,o]=t.useState(""),[S,T]=t.useState(!1),[b,m]=t.useState(""),[A,f]=t.useState([]),[R,I]=t.useState({}),[L,O]=t.useState(s.VARIABLES),[N,{loading:v,error:C,data:V}]=n.useManualQuery("\nquery textSearch($text: String!) {\n  Search(query: $text, filter: [InstanceVariable, RepresentedVariable, Variable, UnitDataSet]) {\n    edges {\n      cursor\n      node {\n        __typename\n        ... on Variable {\n          id\n          name {languageText}\n          description {languageText}\n          subjectFields {edges{node{name{languageText}}}}\n          unitType {name {languageText}}\n        }\n        ... on RepresentedVariable {\n          id\n          name {languageText}\n          description {languageText}\n          variable {\n            subjectFields {edges{node{name{languageText}}}}\n            unitType {name {languageText}} \n          }\n        }\n        ... on InstanceVariable {\n          id\n          name {languageText}\n          description {languageText}\n          representedVariable {\n            variable {\n              subjectFields {edges{node{name{languageText}}}}\n              unitType {name {languageText}} \n            }\n          }\n        }\n        ... on UnitDataSet {\n          id\n          name {languageText}\n          description {languageText}\n          createdDate\n          dataSetState\n          valuation\n        }\n      }\n    }\n  }\n}\n",{variables:{text:c}});t.useEffect(()=>{if(!C&&!v&&void 0!==V){const e=D(V);f(e.datasets),I(e.variables)}},[C,v,V]),t.useEffect(()=>{if(C&&!v){if(void 0!==V)try{const e=D(V);f(e.datasets),I(e.variables)}catch(e){console.log("Tried to extract query results from returned error but could not:"),console.log(e)}console.log(C)}},[V,C,v]);const U=s.VARIABLES.map(e=>d.default.createElement(a.Checkbox,{key:e,label:e,style:{marginRight:"2rem"},checked:L.includes(e),onClick:()=>((e,t)=>{O(e?L.filter(e=>e!==t):L.concat([t]))})(L.includes(e),e)}));return d.default.createElement(a.Segment,{basic:!0,textAlign:"center"},d.default.createElement(a.Label,{attached:"top right",style:{background:"transparent"}},d.default.createElement(l.InfoPopup,{position:"bottom right",text:g.EXTERNAL_GRAPHIQL[r],trigger:d.default.createElement("a",{href:e+"/graphiql",target:"_blank",rel:"noopener noreferrer"},d.default.createElement(a.Icon,{link:!0,size:"large",name:"external",style:{color:l.SSB_COLORS.BLUE}}))})),d.default.createElement(a.Search,{size:"huge",open:!1,loading:v,value:c,placeholder:g.SEARCH[r],onKeyPress:({key:e})=>"Enter"===e&&(u(!0),T(!1),m(c),void N()),onSearchChange:(e,{value:t})=>{T(!0),o(t)}}),i&&S&&d.default.createElement(l.InfoText,{text:E.EDITED[r]}),i&&S&&""!==b&&d.default.createElement(d.default.Fragment,null," (",d.default.createElement("i",null,E.PREVIOUS[r]),"'",d.default.createElement("b",null,b),"')",d.default.createElement("p",null,E.NEW_SEARCH[r])),d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(a.Grid,{columns:"equal"},d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Header,{size:"huge",content:E.DATASET_RESULTS[r]}),v?d.default.createElement(a.Loader,{active:!0,inline:"centered"}):Object.keys(A).length>=1?d.default.createElement(_,{datasets:A,language:r}):i?g.SEARCH_NO_RESULTS[r]:null),d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Header,{size:"huge",content:E.VARIABLE_RESULTS[r]}),U,Object.keys(R).length>=1&&`${E.HITS[r]}: ${Object.keys(R).length}`,d.default.createElement(a.Divider,{hidden:!0}),v?d.default.createElement(a.Loader,{active:!0,inline:"centered"}):Object.keys(R).length>=1?Object.entries(R).filter(e=>L.includes(e[1][0].node[s.TYPE[1]])).map(([e,t])=>d.default.createElement(p,{key:e,id:e,language:r,variables:t})):i?g.SEARCH_NO_RESULTS[r]:null)))},e}({},React,graphqlHooks,semanticUiReact,daplaJsUtilities);
